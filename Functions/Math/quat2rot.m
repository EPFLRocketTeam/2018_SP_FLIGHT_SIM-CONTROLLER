function R = quat2rot(q)
% QUAT2ROT transforms a single quaternion q (4x1) into the equivalent
% rotation matrix R (3x3) which rotates the vehicle's coordinate system into the
% cartesian, terrestrial, coordinate system.

    R = [1-2*q(2).^2-2*q(3).^2,...
    2*(q(1).*q(2) + q(3).*q(4)),...
    2*(q(1).*q(3) - q(2).*q(4));...
    2*(q(1).*q(2) - q(3).*q(4)),...
    1-2*q(1).^2-2*q(3).^2,...
    2*(q(2).*q(3) + q(1).*q(4));...
    2*(q(1).*q(3) + q(2).*q(4)),...   
    2*(q(2).*q(3) - q(1).*q(4)),...   
    1-2*q(1).^2 - 2*q(2).^2]';

end